# EIGRP

EIGRP是最典型得平衡混合路由协议，它融合了距离矢量和链路状态两种路由协议的优点，使用闪速更新算法，能最快的达到网络收敛（convergence）。EIGRP仍然使用传递路由表的方式更新，因此，虽然它具备链路状态协议的特点，但本质上仍是距离矢量协议

**EIGRP协议特点**

- 采用不定期更新，只在路由器改变计量标准或拓扑出现变化时发送部分更新路由
- 更新条目中包含掩码，支持VLSM
- 具有相同的自治系统号的EIGRP和IGRP之间可无缝交换路由信息
- 为多网络协议提供路由支持，通过协议相关模块PDM支持不同网络协议IP、IPX、Apple Talk
- 基于可靠传输协议（RTP）的通信
- 基于弥散更新算法（DUAL）的最佳路由选择
- 使用组播`224.0.0.10`

**EIGRP的三张表**

| 类型   | 作用                                                         |
| ------ | ------------------------------------------------------------ |
| 路由表 | 最终的选路标准                                               |
| 拓扑表 | 收到邻居路由表后会先暂时存入自身的拓扑表，经过计算拓扑表后将最优路由写入到路由表 |
| 邻居表 | EIGRP存在邻居的概念，邻居中断后会将从这个邻居处收到的所有路由条目都删除掉；EIGRP通过hello包检测邻居状态，默认5s检测一次，超过15s无响应则认为邻居故障 |

## 邻居发现

EIGRP路由器彼此交换路由前必须先建立邻居关系，而建立邻居关系需要满足三点条件

- 收到hello或ACK
- 匹配AS号
- 相同度量值

相比较RIP仅通过跳数作为度量值，EIGRP使用复合度量值的方式，复合度量值中包括5个参考值：带宽、延迟、可靠性、负载、MTU。默认情况下EIGRP仅取带宽和延迟作为度量值，而建立邻居所要求的相同度量值，也就是说两个路由器之间的复合度量值所采用的参考值必须相同

**术语**

- 可行距离（FD）：指的是当前设备到达目标网络的全程距离（度量值）；FD值=邻居报告的度量值+报告此路由的邻居度量值
- 被报告距离值（AD）：也称为通告距离，指的是邻居设备到达目标网络的全程距离（度量值）；邻居报告到达远程网络度量
- 邻居表：保存邻接邻居状态信息，端口地址
- 拓扑表：由协议独立模块生成，根据DUAL操作。包含所有邻接路由器的通告的目的地及保持中的每个目的地地址，以及通告这些目的地邻居的列表
- 继任者：也称为后继站，指的是最优线路的下一跳设备；到达远端网络最佳路由，用于转发业务的路由，存在路由表
- 可行继任者：也称为可行后继站，指的是备份线路的下一跳设备；是一条路径，并且比可行距离差，认为是备份路由

**可靠传输协议**

正常情况下EIGRP通过组播地址`224.0.0.10`发送路由表更新信息给邻居时，是需要从邻居处收到回复包的。如果EIGRP发送组播更新给邻居，没有从某个邻居处得到应答时，则通过单播重发同样的数据，16次后仍未得到应答则宣告邻居消失，此为可靠组播传输

16次发送重复数据的时间