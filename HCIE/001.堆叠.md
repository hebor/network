# 园区网典型组网

典型园区组网之一：<font color="red">CSS + Eth-Trunk + iStack</font>

![典型园区组网之一](https://www.z4a.net/images/2024/07/23/ac7e21617895b74588064d1ed90fb25e.png)

典型组网分为核心、汇聚、接入，以交换机为观察角度，一般将网关部署在汇聚层，因此汇聚层也是L2交换和L3路由的临界点。典型组网优势如下

| 优点 | 说明 |
| :-: | :-- |
| 简单 | 使用<font color="red">堆叠</font>技术，逻辑设备少，网络拓扑简单，二层天然无环，无需xSTP |
| 高效 | 使用<font color="red">Eth-Trunk</font>链路聚合技术，负载分担算法灵活，链路利用率高 |
| 可靠 | 服务器和主机可以配置多NIC网卡Teaming负载均衡或主备冗余链路提高服务器接入可靠性<br />堆叠技术同链路聚合技术结合使用，各层物理设备形成双归接入组网，提高整网可靠性 |

缺点：

- 对设备要求较高，盒式设备堆叠台数过多，可能导致堆叠主的主控性能下降
- 如果采用业务口堆叠或集群，会占用业务端口数
- 堆叠皆为厂商私有技术，不同厂商设备无法进行堆叠

华为盒式设备堆叠技术是iStack，框式设备堆叠技术是CSS，盒式设备和框式设备混合堆叠技术是SVF。一般情况下，同型号设备间都处于同一层次（例如接入层），同型号之间的设备进行堆叠又被称为横向虚拟化，与之对应的自然也有纵向虚拟化技术，纵向虚拟化技术实现的就是混合堆叠，框式设备可以将盒式设备当作自身的一块业务卡来使用

> LAG（Link Aggregation Group）链路聚合组，M-LAG（Multichassis Link Aggregation Group）跨设备链路聚合组

## iStack

<font color="red">Intelligent Stack，智能堆叠</font>。将多台支持堆叠特性的交换机设备组合在一起，从逻辑上组合成一台交换设备

**iStack关键术语**

- 角色：堆叠种所有单台交换机都被称为成员交换机，按功能分为三种角色

  | 角色 | 说明 |
  |:-: | :-- |
  | 主交换机 | <font color="red">Master</font>，负责管理整个堆叠，只有一台 |
  | 备交换机 | <font color="red">Standby</font>，主交换机的备份，只有一台 |
  | 从交换机 | <font color="red">Slave</font>，主要用于业务转发，从交换机数量越多，转发能力越强<br />除从交换机和备交换机外，堆叠中其他所有的成员交换机都是从交换机 |

- 堆叠ID：<font color="red">标识和管理</font>成员交换机，即槽位号（Slot ID），此ID唯一
- 堆叠优先级：用于<font color="red">角色选举</font>，越大越优先，当选为主交换机的可能性越大

堆叠ID虽然唯一，但其配置是可选的，在堆叠前可以手动为不同的交换机指定堆叠ID号，如果不手动配置堆叠ID或者手动配置堆叠ID时有误，主交换机都会在堆叠时检测多个交换机的ID，如果多个交换机的ID相同，则也会自动分配堆叠ID

**堆叠连接方式**：堆叠交换机之间必须直连，中间不能有其他的交换机

| 方式 | 说明 |
| :-: | :-: |
| 堆叠卡堆叠 | 通过专用的<font color="red">堆叠插卡</font>及专用的<font color="red">堆叠线缆</font>连接 |
| 业务口堆叠 | 通过与逻辑堆叠端口绑定的物理成员端口相连 |

**堆叠连接拓扑**

| 拓扑 | 描述 |
| :-: | :-: |
| 堆叠链型拓扑 | ![堆叠链型拓扑](https://www.z4a.net/images/2024/07/23/048fa6dc60865fa5ee96df92ad4248e0.png)|
| 堆叠环形拓扑 | ![堆叠环形拓扑](https://www.z4a.net/images/2024/07/23/3559efd1dbe1cd5e4cc170371f66ce4a.png) |